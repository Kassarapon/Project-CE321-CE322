<html>
	<body>
		<div style="display: flex;">
			<p> Game Score : &nbsp; </p>
			<p id="score"></p>
		</div>
		<canvas id="ff" width="590" height="590"></canvas>
	</body>
</html>
<script>
	window.onload = function () {
		canv = document.getElementById("ff");
		ctx = canv.getContext("2d"); // สร้าง context 2d
		document.addEventListener("keydown", keyPush); // ตั้ง key push
		document.getElementById("score").innerHTML = 0; // ตั้งค่าscore 
		setInterval(game, 120); // ตั้งค่าความไวของงู
	}
	positionX = positionY = 10; //ตน.เริ่มต้นของงู
	g1 = g2 = 24; //ขนาดกรอบ
	poitX = poitY = 15;	// ตั้งจุด
	xv = yv = 0;
	trail = [];
	tail = 1;
	score = 0;

	function game() {
		positionX += xv;
		positionY += yv;
		if (positionX < 0) {
			positionX = g2 - 1;
		}
		if (positionX > g2 - 1) {
			positionX = 0;
		}
		if (positionY < 0) {
			positionY = g2 - 1;
		}
		if (positionY > g2 - 1) {
			positionY = 0;
		}
		ctx.fillStyle = "black";	//สีวอล
		ctx.fillRect(0, 0, canv.width, canv.height); //ตน.วอล

		ctx.fillStyle = "blue";	//สีงู
		for (var i = 0; i < trail.length; i++) {
			ctx.fillRect(trail[i].x * g1, trail[i].y * g1, g1 - 2, g1 - 2);
			if (trail[i].x == positionX && trail[i].y == positionY) {
				tail = 3;	//ความยาว
			}
		}
		trail.push({
			x: positionX,
			y: positionY
		});
		while (trail.length > tail) {
			trail.shift();
		}

		if (poitX == positionX && poitY == positionY) {	//งูตอนกิน
			tail++;	// add tail
			document.getElementById("score").innerHTML = ++score;  // เพิ่มความยาวงู
			poitX = Math.floor(Math.random() * g2); // จุดใหม่ที่ x
			poitY = Math.floor(Math.random() * g2); // จุดใหม่ที่ y
		}
		ctx.fillStyle = "white"; //สีจุด
		ctx.fillRect(poitX * g1, poitY * g1, g1 - 2, g1 - 2);
	}

	function keyPush(evt) {
		console.log(evt);
		switch (evt.keyCode) {
			case 37: //ซ้าย
				xv = -1;
				yv = 0;
				break;
			case 38: //ขึ้น
				xv = 0;
				yv = -1;
				break;
			case 39: //ขวา
				xv = 1;
				yv = 0;
				break;
			case 40: //ลง
				xv = 0;
				yv = 1;
				break;
		}
	}
</script>